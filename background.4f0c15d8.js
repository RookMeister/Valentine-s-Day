parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"lhZB":[function(require,module,exports) {
var r={},e={};r.create=function(r,e,t){return{x:r,y:e,z:t}},r.dot=function(r,e){return r.x*e.x+r.y*e.y+r.z*e.z},r.cross=function(r,e,t){r.x=e.y*t.z-e.z*t.y,r.y=e.z*t.x-e.x*t.z,r.z=e.x*t.y-e.y*t.x},r.normalize=function(r){var e=r.x*r.x+r.y*r.y+r.z*r.z;e>1e-5&&(e=1/Math.sqrt(e),r.x*=e,r.y*=e,r.z*=e)},r.arrayForm=function(r){return r.array?(r.array[0]=r.x,r.array[1]=r.y,r.array[2]=r.z):r.array=new Float32Array([r.x,r.y,r.z]),r.array},e.createIdentity=function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},e.loadProjection=function(r,e,t,a,n){var i=a*Math.tan(t*Math.PI/180*.5)*2,o=i*e;r[0]=2*a/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*a/i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=-(n+a)/(n-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=-2*n*a/(n-a),r[15]=0},e.loadLookAt=function(e,t,a,n){var i=r.create(t.x-a.x,t.y-a.y,t.z-a.z);r.normalize(i);var o=r.create(1,0,0);r.cross(o,n,i),r.normalize(o);var f=r.create(1,0,0);r.cross(f,i,o),r.normalize(f),e[0]=o.x,e[1]=f.x,e[2]=i.x,e[3]=0,e[4]=o.y,e[5]=f.y,e[6]=i.y,e[7]=0,e[8]=o.z,e[9]=f.z,e[10]=i.z,e[11]=0,e[12]=-(t.x*e[0]+t.y*e[4]+t.z*e[8]),e[13]=-(t.x*e[1]+t.y*e[5]+t.z*e[9]),e[14]=-(t.x*e[2]+t.y*e[6]+t.z*e[10]),e[15]=1};var t,a={start:0,prev:0,delta:0,elapsed:0},n={width:0,height:0,aspect:1,array:new Float32Array(3),halfWidth:0,halfHeight:0,halfArray:new Float32Array(3)};function i(r){t.deleteFramebuffer(r.frameBuffer),t.deleteRenderbuffer(r.renderBuffer),t.deleteTexture(r.texture)}function o(r,e){var a={width:r,height:e,sizeArray:new Float32Array([r,e,r/e]),dtxArray:new Float32Array([1/r,1/e])};return a.frameBuffer=t.createFramebuffer(),a.renderBuffer=t.createRenderbuffer(),a.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,a.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r,e,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.bindFramebuffer(t.FRAMEBUFFER,a.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a.texture,0),t.bindRenderbuffer(t.RENDERBUFFER,a.renderBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a.renderBuffer),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),a}function f(r,e){var a=t.createShader(r);if(t.shaderSource(a,e),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(a);return t.deleteShader(a),console.error(n),null}return a}function u(r,e,a,n){var i=f(t.VERTEX_SHADER,r),o=f(t.FRAGMENT_SHADER,e);if(null==i||null==o)return null;var u=t.createProgram();if(t.attachShader(u,i),t.attachShader(u,o),t.deleteShader(i),t.deleteShader(o),t.linkProgram(u),!t.getProgramParameter(u,t.LINK_STATUS)){var l=t.getProgramInfoLog(u);return console.error(l),null}if(a){u.uniforms={};for(var s=0;s<a.length;s++)u.uniforms[a[s]]=t.getUniformLocation(u,a[s])}if(n){u.attributes={};for(s=0;s<n.length;s++){var m=n[s];u.attributes[m]=t.getAttribLocation(u,m)}}return u}function l(r){for(var e in t.useProgram(r),r.attributes)t.enableVertexAttribArray(r.attributes[e])}function s(r){for(var e in r.attributes)t.disableVertexAttribArray(r.attributes[e]);t.useProgram(null)}n.setSize=function(r,e){n.width=r,n.height=e,n.aspect=n.width/n.height,n.array[0]=n.width,n.array[1]=n.height,n.array[2]=n.aspect,n.halfWidth=Math.floor(r/2),n.halfHeight=Math.floor(e/2),n.halfArray[0]=n.halfWidth,n.halfArray[1]=n.halfHeight,n.halfArray[2]=n.halfWidth/n.halfHeight};var m={angle:60,nearfar:new Float32Array([.1,100]),matrix:e.createIdentity()},d={position:r.create(0,0,100),lookat:r.create(0,0,0),up:r.create(0,1,0),dof:r.create(10,4,8),matrix:e.createIdentity()},h={},c={},E=!1,y=function(){this.velocity=new Array(3),this.rotation=new Array(3),this.position=new Array(3),this.euler=new Array(3),this.size=1,this.alpha=1,this.zkey=0};function R(){var e=t.getParameter(t.ALIASED_POINT_SIZE_RANGE);n.pointSize={min:e[0],max:e[1]};var a=document.getElementById("sakura_point_vsh").textContent,i=document.getElementById("sakura_point_fsh").textContent;h.program=u(a,i,["uProjection","uModelview","uResolution","uOffset","uDOF","uFade"],["aPosition","aEuler","aMisc"]),l(h.program),h.offset=new Float32Array([0,0,0]),h.fader=r.create(0,10,0),h.numFlowers=1600,h.particles=new Array(h.numFlowers),h.dataArray=new Float32Array(8*h.numFlowers),h.positionArrayOffset=0,h.eulerArrayOffset=3*h.numFlowers,h.miscArrayOffset=6*h.numFlowers,h.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,h.buffer),t.bufferData(t.ARRAY_BUFFER,h.dataArray,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),s(h.program);for(var o=0;o<h.numFlowers;o++)h.particles[o]=new y}function A(){h.area=r.create(20,20,20),h.area.x=h.area.y*n.aspect,h.fader.x=10,h.fader.y=h.area.z,h.fader.z=.1;for(var e=2*Math.PI,t=r.create(0,0,0),a=0,i=function(){return 2*Math.random()-1},o=0;o<h.numFlowers;o++){var f=h.particles[o];t.x=.3*i()+.8,t.y=.2*i()-1,t.z=.3*i()+.5,r.normalize(t),a=2+1*Math.random(),f.setVelocity(t.x*a,t.y*a,t.z*a),f.setRotation(i()*e*.5,i()*e*.5,i()*e*.5),f.setPosition(i()*h.area.x,i()*h.area.y,i()*h.area.z),f.setEulerAngles(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2),f.setSize(.9+.1*Math.random())}}function T(){for(var e=2*Math.PI,i=(h.area.x,h.area.y,h.area.z,function(r,e,t){Math.abs(r.position[e])-.5*r.size>t&&(r.position[e]>0?r.position[e]-=2*t:r.position[e]+=2*t)}),o=function(r,t){r.euler[t]=r.euler[t]%e,r.euler[t]<0&&(r.euler[t]+=e)},f=0;f<h.numFlowers;f++){(y=h.particles[f]).update(a.delta,a.elapsed),i(y,0,h.area.x),i(y,1,h.area.y),i(y,2,h.area.z),o(y,0),o(y,1),o(y,2),y.alpha=1,y.zkey=d.matrix[2]*y.position[0]+d.matrix[6]*y.position[1]+d.matrix[10]*y.position[2]+d.matrix[14]}h.particles.sort(function(r,e){return r.zkey-e.zkey});var u=h.positionArrayOffset,c=h.eulerArrayOffset,E=h.miscArrayOffset;for(f=0;f<h.numFlowers;f++){var y=h.particles[f];h.dataArray[u]=y.position[0],h.dataArray[u+1]=y.position[1],h.dataArray[u+2]=y.position[2],u+=3,h.dataArray[c]=y.euler[0],h.dataArray[c+1]=y.euler[1],h.dataArray[c+2]=y.euler[2],c+=3,h.dataArray[E]=y.size,h.dataArray[E+1]=y.alpha,E+=2}t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);var R=h.program;l(R),t.uniformMatrix4fv(R.uniforms.uProjection,!1,m.matrix),t.uniformMatrix4fv(R.uniforms.uModelview,!1,d.matrix),t.uniform3fv(R.uniforms.uResolution,n.array),t.uniform3fv(R.uniforms.uDOF,r.arrayForm(d.dof)),t.uniform3fv(R.uniforms.uFade,r.arrayForm(h.fader)),t.bindBuffer(t.ARRAY_BUFFER,h.buffer),t.bufferData(t.ARRAY_BUFFER,h.dataArray,t.DYNAMIC_DRAW),t.vertexAttribPointer(R.attributes.aPosition,3,t.FLOAT,!1,0,h.positionArrayOffset*Float32Array.BYTES_PER_ELEMENT),t.vertexAttribPointer(R.attributes.aEuler,3,t.FLOAT,!1,0,h.eulerArrayOffset*Float32Array.BYTES_PER_ELEMENT),t.vertexAttribPointer(R.attributes.aMisc,2,t.FLOAT,!1,0,h.miscArrayOffset*Float32Array.BYTES_PER_ELEMENT);for(f=1;f<2;f++){var A=-2*f;h.offset[0]=-1*h.area.x,h.offset[1]=-1*h.area.y,h.offset[2]=h.area.z*A,t.uniform3fv(R.uniforms.uOffset,h.offset),t.drawArrays(t.POINT,0,h.numFlowers),h.offset[0]=-1*h.area.x,h.offset[1]=1*h.area.y,h.offset[2]=h.area.z*A,t.uniform3fv(R.uniforms.uOffset,h.offset),t.drawArrays(t.POINT,0,h.numFlowers),h.offset[0]=1*h.area.x,h.offset[1]=-1*h.area.y,h.offset[2]=h.area.z*A,t.uniform3fv(R.uniforms.uOffset,h.offset),t.drawArrays(t.POINT,0,h.numFlowers),h.offset[0]=1*h.area.x,h.offset[1]=1*h.area.y,h.offset[2]=h.area.z*A,t.uniform3fv(R.uniforms.uOffset,h.offset),t.drawArrays(t.POINT,0,h.numFlowers)}h.offset[0]=0,h.offset[1]=0,h.offset[2]=0,t.uniform3fv(R.uniforms.uOffset,h.offset),t.drawArrays(t.POINT,0,h.numFlowers),t.bindBuffer(t.ARRAY_BUFFER,null),s(R),t.enable(t.DEPTH_TEST),t.disable(t.BLEND)}function F(r,e,a,n){var i={},o=["uResolution","uSrc","uDelta"];a&&(o=o.concat(a));var f=["aPosition"];return n&&(f=f.concat(n)),i.program=u(r,e,o,f),l(i.program),i.dataArray=new Float32Array([-1,-1,1,-1,-1,1,1,1]),i.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i.buffer),t.bufferData(t.ARRAY_BUFFER,i.dataArray,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),s(i.program),i}function p(r,e){var a=r.program;l(a),t.uniform3fv(a.uniforms.uResolution,n.array),null!=e&&(t.uniform2fv(a.uniforms.uDelta,e.dtxArray),t.uniform1i(a.uniforms.uSrc,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.texture))}function B(r){t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(r.program.attributes.aPosition,2,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,4)}function _(r){s(r.program)}y.prototype.setVelocity=function(r,e,t){this.velocity[0]=r,this.velocity[1]=e,this.velocity[2]=t},y.prototype.setRotation=function(r,e,t){this.rotation[0]=r,this.rotation[1]=e,this.rotation[2]=t},y.prototype.setPosition=function(r,e,t){this.position[0]=r,this.position[1]=e,this.position[2]=t},y.prototype.setEulerAngles=function(r,e,t){this.euler[0]=r,this.euler[1]=e,this.euler[2]=t},y.prototype.setSize=function(r){this.size=r},y.prototype.update=function(r,e){this.position[0]+=this.velocity[0]*r,this.position[1]+=this.velocity[1]*r,this.position[2]+=this.velocity[2]*r,this.euler[0]+=this.rotation[0]*r,this.euler[1]+=this.rotation[1]*r,this.euler[2]+=this.rotation[2]*r};var x={};function v(){var r,e,t=document.getElementById("fx_common_vsh").textContent;e=document.getElementById("bg_fsh").textContent,x.sceneBg=F(t,e,["uTimes"],null),e=document.getElementById("fx_brightbuf_fsh").textContent,x.mkBrightBuf=F(t,e,null,null),e=document.getElementById("fx_dirblur_r4_fsh").textContent,x.dirBlur=F(t,e,["uBlurDir"],null),r=document.getElementById("pp_final_vsh").textContent,e=document.getElementById("pp_final_fsh").textContent,x.finalComp=F(r,e,["uBloom"],null)}function g(){}function b(){}function w(){t.disable(t.DEPTH_TEST),p(x.sceneBg,null),t.uniform2f(x.sceneBg.program.uniforms.uTimes,a.elapsed,a.delta),B(x.sceneBg),_(x.sceneBg),t.enable(t.DEPTH_TEST)}var P={};function z(){}function D(){}function I(){t.enable(t.TEXTURE_2D),t.disable(t.DEPTH_TEST);var r=function(r,e){t.bindFramebuffer(t.FRAMEBUFFER,r.frameBuffer),t.viewport(0,0,r.width,r.height),e&&(t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT))};r(n.wHalfRT0,!0),p(x.mkBrightBuf,n.mainRT),B(x.mkBrightBuf),_(x.mkBrightBuf);for(var e=0;e<2;e++){var a=1.5+1*e,i=2+1*e;r(n.wHalfRT1,!0),p(x.dirBlur,n.wHalfRT0),t.uniform4f(x.dirBlur.program.uniforms.uBlurDir,a,0,i,0),B(x.dirBlur),_(x.dirBlur),r(n.wHalfRT0,!0),p(x.dirBlur,n.wHalfRT1),t.uniform4f(x.dirBlur.program.uniforms.uBlurDir,0,a,0,i),B(x.dirBlur),_(x.dirBlur)}t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,n.width,n.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),p(x.finalComp,n.mainRT),t.uniform1i(x.finalComp.program.uniforms.uBloom,1),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,n.wHalfRT0.texture),B(x.finalComp),_(x.finalComp),t.enable(t.DEPTH_TEST)}var M={};function U(){v(),g(),R(),z(),E=!0}function S(){b(),A(),D(),d.position.z=h.area.z+m.nearfar[0],m.angle=180*Math.atan2(h.area.y,d.position.z+h.area.z)/Math.PI*2,e.loadProjection(m.matrix,n.aspect,m.angle,m.nearfar[0],m.nearfar[1])}function O(){e.loadLookAt(d.matrix,d.position,d.lookat,d.up),t.enable(t.DEPTH_TEST),t.bindFramebuffer(t.FRAMEBUFFER,n.mainRT.frameBuffer),t.viewport(0,0,n.mainRT.width,n.mainRT.height),t.clearColor(.005,0,.05,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),w(),T(),I()}function H(r){Y(document.getElementById("sakura")),L(),E&&S()}function L(){n.setSize(t.canvas.width,t.canvas.height),t.clearColor(.2,.2,.5,1),t.viewport(0,0,n.width,n.height);var r=function(r,e,t){var a=n[r];a&&i(a),n[r]=o(e,t)};r("mainRT",n.width,n.height),r("wFullRT0",n.width,n.height),r("wFullRT1",n.width,n.height),r("wHalfRT0",n.halfWidth,n.halfHeight),r("wHalfRT1",n.halfWidth,n.halfHeight)}function C(){O()}var N=!0;function k(r){(N^=!0)&&W(),r&&(r.innerHTML=N?"Stop":"Start")}function X(){N||W()}function W(){var r=new Date;a.elapsed=(r-a.start)/1e3,a.delta=(r-a.prev)/1e3,a.prev=r,N&&requestAnimationFrame(W),C()}function Y(r){var e=document.body,t=document.documentElement;fullw=Math.max(e.clientWidth,e.scrollWidth,t.scrollWidth,t.clientWidth),fullh=Math.max(e.clientHeight,e.scrollHeight,t.scrollHeight,t.clientHeight),r.width=fullw,r.height=fullh}window.addEventListener("load",function(r){var e=document.getElementById("sakura");try{Y(e),t=e.getContext("experimental-webgl")}catch(r){return alert("WebGL not supported."+r),void console.error(r)}window.addEventListener("resize",H),L(),U(),S(),a.start=new Date,a.prev=a.start,W()}),function(r,e){r["r"+e]=r["r"+e]||r["webkitR"+e]||r["mozR"+e]||r["msR"+e]||r["oR"+e]||function(e){r.setTimeout(e,1e3/60)}}(window,"equestAnimationFrame");
},{}]},{},["lhZB"], null)
//# sourceMappingURL=/background.4f0c15d8.map